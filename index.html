<!DOCTYPE html>
<html>

<script src="https://unpkg.com/read-excel-file@5.x/bundle/read-excel-file.min.js"></script>

<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <link href="styles.css" rel="stylesheet">
  <link rel="icon" href="favicon.ico" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <script src="upload.js"></script>
  <title>Upload</title>
  <!-- <input type="file" id="input"/> -->
  <!-- <button onclick="upload(unchangedRows)">Upload</button> -->
  
</head>

<body>
  <div id="drop-area">
    <form class="my-form">
      <p>Drag and drop a custom excel file to get started</p>
      <input type="file" id="fileElem" onchange="handleFiles(this.files)">
      <label class="button" for="fileElem">Select Spreadsheet</label>
    </form>
    <!-- <progress id="progress-bar" max=100 value=0></progress> -->
    </div>
    
    <script src="selectFile.js"></script>
    
    <div id="speakerlistholder"></div>
</body>

<script language="javascript" src="utils.js"></script>
<script language="javascript" src="interpretData.js"></script>




<script>
  var unchangedRows = {};
  var input = document.getElementById('input')
  var fileSelector = document.getElementById('drop-area')
  input.addEventListener('change', function() {
    readXlsxFile(input.files[0]).then(function(rows) {
        // `rows` is an array of rows
      // each row being an array of cells.
        //console.log(rows)
      
      retrieveDate(rows)
      findRoomRow(rows)
      listRooms(rows)
      listSpeakers(rows)
      handleGlobalRows(rows)
      handleEmptyCells(rows)
      convertDatesToInt(rows)
      replaceStringCharacter(rows, '<', '')
      replaceStringCharacter(rows, '>', '')
      createTable(rows)
      printSpeakers(speakers)
      input.remove()
      var button = document.createElement('button')
      button.textContent = 'Upload'
      document.body.appendChild(button)
      console.log(rows)
      upload(rows)
      
    })
  })
</script>

</html>